<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Program Pendampingan Usaha Santri - SINEKRA</title>
    <link rel="icon" href="assets/logo_sinergi_krapyak.jpg" type="image/jpeg">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        sinekra: {
                            primary: '#667eea', // Konsisten dengan brand SINEKRA
                            secondary: '#5396FF',
                            light: '#f8faff',
                        }
                    },
                    boxShadow: {
                        'thin': '0 2px 4px rgba(0,0,0,0.05)',
                        'card': '0 4px 8px rgba(0,0,0,0.08)',
                    }
                }
            }
        }
    </script>
    <style>
        /* Header styling konsisten dengan SINEKRA */
        .main-header {
            background-color: #ffffff;
            border-bottom: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1240px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            margin-left: auto;
            gap: 20px;
        }
        
        .logo {
            height: 50px;
            width: auto;
        }
        
        .nav-link {
            color: #5396FF;
            font-weight: 500;
            position: relative;
            padding: 8px 16px;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease-in-out;
        }
        
        .nav-link:hover {
            color: #667eea;
            background-color: rgba(102, 126, 234, 0.08);
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #667eea;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .autocomplete-items {
            position: absolute;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #fff;
            max-height: 200px;
            overflow-y: auto;
        }
        .autocomplete-items div {
            padding: 12px 16px;
            cursor: pointer;
            background-color: #fff;
            border-bottom: 1px solid #f3f4f6;
            transition: background-color 0.15s ease;
        }
        .autocomplete-items div:hover {
            background-color: #f8fafc;
        }
        .autocomplete-items div:last-child {
            border-bottom: none;
        }
        .autocomplete-active {
            background-color: #667eea !important;
            color: #ffffff;
        }
        
        /* Responsive improvements untuk mobile */
        @media (max-width: 768px) {
            .header-wrapper {
                padding: 0 15px;
            }
            
            .main-container {
                padding: 1rem !important;
            }
            
            .form-container {
                padding: 1.5rem !important;
                margin: 1rem !important;
                border-radius: 12px;
            }
            
            .form-title {
                font-size: 1.5rem !important;
                margin-bottom: 1rem !important;
            }
            
            .form-description {
                font-size: 0.9rem !important;
                margin-bottom: 1.5rem !important;
            }
            
            .hero-image {
                margin-bottom: 1.5rem !important;
            }
            
            .form-field {
                margin-bottom: 1.25rem !important;
            }
            
            .form-input, .form-textarea, .form-select {
                padding: 0.875rem !important;
                font-size: 1rem !important;
                border-radius: 8px !important;
            }
            
            .submit-section {
                flex-direction: column !important;
                gap: 1rem !important;
                align-items: stretch !important;
            }
            
            .whatsapp-links {
                justify-content: center !important;
                order: -1;
            }
            
            .submit-button {
                width: 100% !important;
                padding: 1rem !important;
                font-size: 1.1rem !important;
            }
        }
        
        /* Form styling improvements */
        input:focus, textarea:focus, select:focus {
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
            border-color: #667eea !important;
        }
        
        /* Loading state */
        .loading-state {
            opacity: 0.7;
            pointer-events: none;
        }
        
        /* Enhanced mobile UX */
        .mobile-optimized {
            touch-action: manipulation;
        }
        
        /* Better spacing for mobile forms */
        @media (max-width: 640px) {
            .space-y-6 > * + * {
                margin-top: 1.25rem !important;
            }
            
            .space-y-4 > * + * {
                margin-top: 1rem !important;
            }
        }
    </style>
  </head>
<body class="bg-sinekra-light min-h-screen">
    <!-- Header konsisten dengan SINEKRA -->
    <header class="main-header">
        <div class="header-wrapper">
            <a href="index.html" class="logo-link">
                <img src="assets/logo_sinergi_krapyak.jpg" alt="Logo Sinergi Krapyak" class="logo">
            </a>
            <div class="header-right">
                <nav class="main-nav hidden md:flex gap-5">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="form.html" class="nav-link">Isi Form</a>
                    <a href="statistik.html" class="nav-link">Statistik</a>
                    <a href="tentang.html" class="nav-link">Tentang</a>
                    <a href="program-pendampingan.html" class="nav-link bg-sinekra-primary text-white rounded-lg px-3">Program Pendampingan</a>
                </nav>
                <div class="mobile-menu-trigger md:hidden">
                    <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </div>
            </div>
        </div>
    </header>

    <div class="main-container min-h-screen py-8 px-4 md:px-6 bg-gradient-to-br from-sinekra-light to-white">
        <div class="container max-w-4xl mx-auto">
            <div class="form-container bg-white rounded-xl shadow-card p-6 md:p-8">
                <!-- Header Section -->
                <div class="text-center mb-8">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-sinekra-primary rounded-full mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                    </div>
                    <h1 class="form-title text-3xl font-bold text-gray-800 mb-4">Program Pendampingan Usaha Santri</h1>
                    <p class="form-description text-gray-600 leading-relaxed max-w-3xl mx-auto">
                        <span class="text-sinekra-primary font-semibold">Assalamualaikum Warahmatullahi Wabarakatuh.</span><br>
                        Dengan ini kami mengundang para anggota komunitas Sinergi Ekonomi Santri untuk mengikuti program pendampingan usaha dan pengembangan profesi. Harap diisi dengan penuh kesungguhan agar kita bisa saling bersinergi dan bertumbuh bersama.
                    </p>
                    <div class="hero-image mt-6">
                        <img src="./assets/program-pendampingan.jpg" alt="Program Pendampingan" class="w-full max-w-2xl mx-auto rounded-xl shadow-card">
                    </div>
                </div>

                <!-- Form -->
                <form id="pendampinganForm" class="space-y-6 mobile-optimized">
                    <!-- Nama Anggota -->
                    <div class="form-field relative">
                        <label class="block text-gray-700 font-semibold mb-2 text-sm">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-2 text-sinekra-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                </svg>
                                Nama Lengkap Anggota
                            </span>
                        </label>
                        <div class="relative">
                            <input type="text" id="namaAnggota" class="form-input block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200" placeholder="Ketik nama lengkap..." required>
                            <div id="autocompleteList" class="autocomplete-items"></div>
                        </div>
                        <div class="mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200">
                            <p class="text-sm text-blue-700">
                                <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Belum terdaftar sebagai anggota? 
                                <a href="https://krapyakid.github.io/sinekra/form.html" class="text-sinekra-primary hover:text-sinekra-secondary font-medium underline">Daftar di sini</a>
                            </p>
                        </div>
                    </div>

                    <!-- Alamat -->
                    <div class="form-field">
                        <label class="block text-gray-700 font-semibold mb-2 text-sm">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-2 text-sinekra-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                                </svg>
                                Alamat Lengkap
                            </span>
                        </label>
                        <textarea id="alamat" rows="3" class="form-textarea block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200 resize-none" placeholder="Masukkan alamat lengkap..." required></textarea>
                    </div>

                    <!-- No. Telp/WA -->
                    <div class="form-field">
                        <label class="block text-gray-700 font-semibold mb-2 text-sm">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-2 text-sinekra-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                                </svg>
                                No. Telp/WhatsApp
                            </span>
                        </label>
                        <input type="tel" id="noTelp" class="form-input block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200" placeholder="08xxxxxxxxxx atau 62xxxxxxxxxx" required>
                        <p class="mt-1 text-xs text-gray-500">Format: 08xxxxxxxxxx atau 62xxxxxxxxxx</p>
                    </div>

                    <!-- Data Usaha -->
                    <div class="form-field">
                        <div id="usahaExisting" class="hidden">
                            <label class="block text-gray-700 font-semibold mb-2 text-sm">
                                <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-2 text-sinekra-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                                    </svg>
                                    Pilih Usaha Anda
                                </span>
                            </label>
                            <select id="usahaList" class="form-select block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200">
                                <option value="">Pilih usaha...</option>
                            </select>
                            <div id="detailUsaha" class="mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200 hidden">
                                <h4 class="font-semibold text-gray-700 mb-2">Detail Usaha:</h4>
                                <p id="kategoriUsaha" class="text-sm text-gray-600 mb-1"></p>
                                <p id="jenisUsaha" class="text-sm text-gray-600"></p>
                            </div>
                        </div>

                        <div id="usahaBaru">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2 text-sm">
                                        <span class="flex items-center">
                                            <svg class="w-4 h-4 mr-2 text-sinekra-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                                            </svg>
                                            Nama Usaha
                                        </span>
                                    </label>
                                    <input type="text" id="namaUsahaBaru" class="form-input block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200" placeholder="Masukkan nama usaha">
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-gray-700 font-semibold mb-2 text-sm">Kategori Usaha</label>
                                        <input type="text" id="kategoriUsahaBaru" class="form-input block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200" placeholder="Misal: Kuliner, Fashion, dll">
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 font-semibold mb-2 text-sm">Jenis Usaha</label>
                                        <input type="text" id="jenisUsahaBaru" class="form-input block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200" placeholder="Misal: Online, Offline, Hybrid">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2 text-sm">Deskripsi Singkat</label>
                                    <textarea id="deskripsiUsaha" rows="3" class="form-textarea block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200 resize-none" placeholder="Ceritakan singkat tentang usaha Anda..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Kendala -->
                    <div class="form-field">
                        <label class="block text-gray-700 font-semibold mb-2 text-sm">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-2 text-sinekra-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Kendala yang Dihadapi
                            </span>
                        </label>
                        <textarea id="kendala" rows="4" class="form-textarea block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-thin focus:border-sinekra-primary focus:ring-2 focus:ring-sinekra-primary focus:ring-opacity-20 transition-all duration-200 resize-none" placeholder="Ceritakan kendala atau tantangan yang sedang dihadapi dalam mengembangkan usaha..." required></textarea>
                        <p class="mt-1 text-xs text-gray-500">Contoh: masalah pemasaran, modal, produksi, dll.</p>
                    </div>

                    <!-- Komitmen -->
                    <div class="form-field">
                        <label class="block text-gray-700 font-semibold mb-3 text-sm">
                            <span class="flex items-center">
                                <svg class="w-4 h-4 mr-2 text-sinekra-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Komitmen Mengikuti Program
                            </span>
                        </label>
                        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4 mb-4">
                            <p class="text-sm text-gray-700 font-medium">Saya bersedia mengikuti pendampingan hingga program ini selesai.</p>
                        </div>
                        <div class="space-y-3">
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-green-300 transition-colors cursor-pointer">
                                <input type="radio" name="komitmen" value="ya" class="text-green-600 focus:ring-green-500 focus:ring-2" required>
                                <span class="ml-3 flex items-center text-gray-700 font-medium">
                                    <span class="text-green-600 text-lg mr-2">‚úÖ</span>
                                    Ya, saya bersedia berkomitmen penuh
                                </span>
                            </label>
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-red-300 transition-colors cursor-pointer">
                                <input type="radio" name="komitmen" value="tidak" class="text-red-600 focus:ring-red-500 focus:ring-2">
                                <span class="ml-3 flex items-center text-gray-700 font-medium">
                                    <span class="text-red-600 text-lg mr-2">‚ùå</span>
                                    Tidak / Belum bisa berkomitmen
                                </span>
                            </label>
                        </div>
                    </div>

                    <!-- Info Upload -->
                    <div class="bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <svg class="w-5 h-5 text-green-600 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-1">üì∏ Catatan untuk Foto Usaha</h4>
                                <p class="text-sm text-gray-600 leading-relaxed">
                                    Foto usaha dapat dikirim ke nomor WhatsApp PIC dengan format:<br>
                                    <code class="bg-white px-3 py-1 rounded border text-sinekra-primary font-mono text-xs mt-1 inline-block">
                                        #NamaUsaha #NamaPemilikUsaha
                                    </code>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="submit-section flex items-center justify-between pt-6 border-t border-gray-200">
                        <button type="submit" class="submit-button bg-gradient-to-r from-sinekra-primary to-sinekra-secondary text-white px-8 py-4 rounded-xl hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-sinekra-primary focus:ring-opacity-30 transition-all duration-300 font-semibold flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                            </svg>
                            <span>Konfirmasi dan Kirim</span>
                            <div class="loading-spinner ml-2"></div>
                        </button>
                        
                        <div class="whatsapp-links flex flex-col md:flex-row gap-2 md:gap-4 text-sm">
                            <a href="https://wa.me/081395711956" target="_blank" class="flex items-center text-gray-600 hover:text-green-600 transition-colors">
                                <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.515"/>
                                </svg>
                                Hubungi VIVI
                            </a>
                            <a href="https://wa.me/085190028089" target="_blank" class="flex items-center text-gray-600 hover:text-green-600 transition-colors">
                                <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.515"/>
                                </svg>
                                Hubungi NAJIB
                            </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Konfirmasi -->
    <div id="confirmationModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center">
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full mx-4">
            <h3 class="text-xl font-semibold text-gray-700 mb-4">Konfirmasi Pengiriman</h3>
            <div id="confirmationContent" class="text-gray-600 mb-6"></div>
            <div class="flex justify-end space-x-4">
                <button onclick="closeModal()" class="px-4 py-2 text-gray-600 hover:text-gray-800">Batal</button>
                <button onclick="submitForm()" class="px-4 py-2 bg-sinekra-primary text-white rounded-md hover:bg-sinekra-secondary">Kirim</button>
            </div>
        </div>
    </div>

    <script>
        // Konfigurasi Google Sheet - URL untuk mengambil data anggota dari sheet anggota_sinekra_v2
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbwVqtYqJ5-ysXyaC3M7KAc2POl_8OtTH5aSL6OHPm9Jf95T9IGGD8aXfreTEhN9o0d4/exec';
        const USAHA_SHEET_URL = 'https://script.google.com/macros/s/AKfycbwVqtYqJ5-ysXyaC3M7KAc2POl_8OtTH5aSL6OHPm9Jf95T9IGGD8aXfreTEhN9o0d4/exec?sheet=usaha_anggota';
        
        let anggotaData = [];
        let usahaData = [];
        let selectedAnggota = null;

        // Fetch data anggota dan usaha saat halaman dimuat
        Promise.all([
            fetch(SHEET_URL).then(response => response.json()),
            fetch(USAHA_SHEET_URL).then(response => response.json())
        ])
        .then(([anggota, usaha]) => {
            anggotaData = anggota;
            usahaData = usaha;
            setupAutocomplete();
        })
        .catch(error => {
            console.error('Error fetching data:', error);
            // Fallback: tetap setup autocomplete meski tanpa data
            setupAutocomplete();
        });

        // Setup Autocomplete
        function setupAutocomplete() {
            const input = document.getElementById('namaAnggota');
            const autocompleteList = document.getElementById('autocompleteList');

            input.addEventListener('input', function() {
                const value = this.value.toLowerCase().trim();
                autocompleteList.innerHTML = '';

                if (!value || value.length < 2) {
                    autocompleteList.style.display = 'none';
                    return;
                }

                const matches = anggotaData.filter(anggota => 
                    anggota.nama_lengkap && anggota.nama_lengkap.toLowerCase().includes(value)
                ).slice(0, 10); // Batasi hasil maksimal 10

                if (matches.length > 0) {
                    autocompleteList.style.display = 'block';
                    matches.forEach(anggota => {
                        const div = document.createElement('div');
                        div.textContent = anggota.nama_lengkap;
                        div.className = 'hover:bg-sinekra-secondary cursor-pointer';
                        div.addEventListener('click', () => {
                            selectedAnggota = anggota;
                            input.value = anggota.nama_lengkap;
                            document.getElementById('alamat').value = anggota.detail_alamat || '';
                            document.getElementById('noTelp').value = anggota.no_hp_anggota || '';
                            
                            // Cari usaha berdasarkan ID anggota
                            const anggotaUsaha = usahaData.filter(usaha => 
                                usaha.id_anggota === anggota.id || usaha.nama_lengkap === anggota.nama_lengkap
                            );
                            
                            if (anggotaUsaha.length > 0) {
                                document.getElementById('usahaExisting').classList.remove('hidden');
                                document.getElementById('usahaBaru').classList.add('hidden');
                                
                                const usahaList = document.getElementById('usahaList');
                                usahaList.innerHTML = '<option value="">Pilih usaha...</option>';
                                anggotaUsaha.forEach(usaha => {
                                    const option = document.createElement('option');
                                    option.value = usaha.id || usaha.nama_usaha;
                                    option.textContent = usaha.nama_usaha;
                                    option.dataset.kategori = usaha.kategori_usaha || '';
                                    option.dataset.jenis = usaha.jenis_usaha || '';
                                    usahaList.appendChild(option);
                                });
                            } else {
                                document.getElementById('usahaExisting').classList.add('hidden');
                                document.getElementById('usahaBaru').classList.remove('hidden');
                            }
                            
                            autocompleteList.style.display = 'none';
                        });
                        autocompleteList.appendChild(div);
                    });
                } else {
                    autocompleteList.style.display = 'none';
                    // Tampilkan pesan jika tidak ada hasil
                    if (value.length >= 2) {
                        const div = document.createElement('div');
                        div.textContent = 'Tidak ada anggota ditemukan';
                        div.className = 'text-gray-500 italic';
                        autocompleteList.appendChild(div);
                        autocompleteList.style.display = 'block';
                    }
                }
            });
        }

        // Handle form submission
        document.getElementById('pendampinganForm').addEventListener('submit', function(e) {
            e.preventDefault();
            showConfirmationModal();
        });

        function showConfirmationModal() {
            // Validasi form terlebih dahulu
            const komitmenChecked = document.querySelector('input[name="komitmen"]:checked');
            if (!komitmenChecked) {
                alert('Mohon pilih komitmen mengikuti program terlebih dahulu.');
                return;
            }

            const modal = document.getElementById('confirmationModal');
            const content = document.getElementById('confirmationContent');
            
            // Prepare confirmation content
            const usahaExisting = !document.getElementById('usahaExisting').classList.contains('hidden');
            const usahaText = usahaExisting 
                ? (document.getElementById('usahaList').selectedIndex > 0 
                    ? document.getElementById('usahaList').options[document.getElementById('usahaList').selectedIndex].text 
                    : 'Belum dipilih')
                : (document.getElementById('namaUsahaBaru').value || 'Belum diisi');

            const formData = {
                nama: document.getElementById('namaAnggota').value,
                alamat: document.getElementById('alamat').value,
                noTelp: document.getElementById('noTelp').value,
                komitmen: komitmenChecked.value === 'ya' ? '‚úÖ Ya, bersedia' : '‚ùå Tidak / Belum bisa',
                kendala: document.getElementById('kendala').value,
                usaha: usahaText,
                kategoriUsaha: usahaExisting && document.getElementById('usahaList').selectedIndex > 0 
                    ? document.getElementById('usahaList').options[document.getElementById('usahaList').selectedIndex].dataset.kategori 
                    : document.getElementById('kategoriUsahaBaru').value,
                jenisUsaha: usahaExisting && document.getElementById('usahaList').selectedIndex > 0 
                    ? document.getElementById('usahaList').options[document.getElementById('usahaList').selectedIndex].dataset.jenis 
                    : document.getElementById('jenisUsahaBaru').value,
                deskripsiUsaha: document.getElementById('deskripsiUsaha').value
            };

            content.innerHTML = `
                <div class="space-y-3 text-sm">
                    <div><strong>Nama:</strong> ${formData.nama}</div>
                    <div><strong>Alamat:</strong> ${formData.alamat}</div>
                    <div><strong>No. Telp:</strong> ${formData.noTelp}</div>
                    <div><strong>Nama Usaha:</strong> ${formData.usaha}</div>
                    ${formData.kategoriUsaha ? `<div><strong>Kategori:</strong> ${formData.kategoriUsaha}</div>` : ''}
                    ${formData.jenisUsaha ? `<div><strong>Jenis Usaha:</strong> ${formData.jenisUsaha}</div>` : ''}
                    ${formData.deskripsiUsaha ? `<div><strong>Deskripsi:</strong> ${formData.deskripsiUsaha}</div>` : ''}
                    <div><strong>Kendala:</strong> ${formData.kendala.substring(0, 100)}${formData.kendala.length > 100 ? '...' : ''}</div>
                    <div><strong>Komitmen:</strong> ${formData.komitmen}</div>
                    <div class="mt-4 text-xs italic text-gray-500 border-t pt-2">
                        Pastikan data di atas sudah benar. Data yang sudah dikirim tidak dapat diubah.
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeModal() {
            const modal = document.getElementById('confirmationModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        async function submitForm() {
            const spinner = document.querySelector('.loading-spinner');
            const submitButton = document.querySelector('button[type="submit"] span');
            const originalText = submitButton.textContent;
            
            try {
                spinner.style.display = 'inline-block';
                submitButton.textContent = 'Mengirim data... mohon tunggu';
                document.querySelector('button[type="submit"]').disabled = true;

                // Kumpulkan data form untuk dikirim
                const usahaExisting = !document.getElementById('usahaExisting').classList.contains('hidden');
                const submitData = {
                    timestamp: new Date().toISOString(),
                    nama_lengkap: document.getElementById('namaAnggota').value,
                    alamat: document.getElementById('alamat').value,
                    no_telp: document.getElementById('noTelp').value,
                    nama_usaha: usahaExisting 
                        ? (document.getElementById('usahaList').selectedIndex > 0 
                            ? document.getElementById('usahaList').options[document.getElementById('usahaList').selectedIndex].text 
                            : '')
                        : document.getElementById('namaUsahaBaru').value,
                    kategori_usaha: usahaExisting && document.getElementById('usahaList').selectedIndex > 0 
                        ? document.getElementById('usahaList').options[document.getElementById('usahaList').selectedIndex].dataset.kategori 
                        : document.getElementById('kategoriUsahaBaru').value,
                    jenis_usaha: usahaExisting && document.getElementById('usahaList').selectedIndex > 0 
                        ? document.getElementById('usahaList').options[document.getElementById('usahaList').selectedIndex].dataset.jenis 
                        : document.getElementById('jenisUsahaBaru').value,
                    deskripsi_usaha: document.getElementById('deskripsiUsaha').value,
                    kendala: document.getElementById('kendala').value,
                    komitmen: document.querySelector('input[name="komitmen"]:checked').value,
                    status: 'pending',
                    sumber: 'web_form'
                };

                // POST ke Google Sheet (ganti dengan URL endpoint yang sesuai)
                const response = await fetch('https://script.google.com/macros/s/AKfycbwVqtYqJ5-ysXyaC3M7KAc2POl_8OtTH5aSL6OHPm9Jf95T9IGGD8aXfreTEhN9o0d4/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'addPendampingan',
                        data: submitData
                    })
                });

                // Simulasi delay untuk UX yang lebih baik
                await new Promise(resolve => setTimeout(resolve, 1500));

                alert('‚úÖ Data berhasil dikirim!\n\nTerima kasih atas partisipasinya dalam Program Pendampingan Usaha Santri. Tim kami akan segera menghubungi Anda untuk langkah selanjutnya.\n\nBarakallahu fiikum ü§≤');
                closeModal();
                resetFormState();
                
            } catch (error) {
                alert('‚ùå Terjadi kesalahan saat mengirim data.\n\nSilakan coba lagi atau hubungi PIC melalui WhatsApp jika masalah berlanjut.');
                console.error('Error:', error);
            } finally {
                spinner.style.display = 'none';
                submitButton.textContent = originalText;
                document.querySelector('button[type="submit"]').disabled = false;
            }
        }

        // Handle usaha selection
        document.getElementById('usahaList').addEventListener('change', function() {
            const detailUsaha = document.getElementById('detailUsaha');
            const selectedOption = this.options[this.selectedIndex];
            
            if (selectedOption && selectedOption.value) {
                const kategori = selectedOption.dataset.kategori;
                const jenis = selectedOption.dataset.jenis;
                
                document.getElementById('kategoriUsaha').textContent = `Kategori: ${kategori || 'Tidak tersedia'}`;
                document.getElementById('jenisUsaha').textContent = `Jenis: ${jenis || 'Tidak tersedia'}`;
                detailUsaha.classList.remove('hidden');
            } else {
                detailUsaha.classList.add('hidden');
            }
        });

        // Close autocomplete when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('#namaAnggota')) {
                document.getElementById('autocompleteList').style.display = 'none';
            }
        });

        // Validasi real-time untuk form
        function setupFormValidation() {
            const requiredFields = ['namaAnggota', 'alamat', 'noTelp', 'kendala'];
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('blur', function() {
                        if (!this.value.trim()) {
                            this.classList.add('border-red-300');
                        } else {
                            this.classList.remove('border-red-300');
                        }
                    });
                }
            });

            // Validasi nomor telepon
            document.getElementById('noTelp').addEventListener('input', function() {
                const value = this.value.replace(/\D/g, ''); // Hapus non-digit
                this.value = value;
                
                if (value.length > 0 && !value.startsWith('08') && !value.startsWith('62')) {
                    this.setCustomValidity('Nomor telepon harus dimulai dengan 08 atau 62');
                } else {
                    this.setCustomValidity('');
                }
            });
        }

        // Inisialisasi validasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            setupFormValidation();
            
            // Tambahkan indikator loading
            const form = document.getElementById('pendampinganForm');
            form.addEventListener('submit', function() {
                form.classList.add('loading-state');
            });
        });

        // Reset form state setelah submit
        function resetFormState() {
            const form = document.getElementById('pendampinganForm');
            form.classList.remove('loading-state');
            form.reset();
            selectedAnggota = null;
            document.getElementById('usahaExisting').classList.add('hidden');
            document.getElementById('usahaBaru').classList.remove('hidden');
            document.getElementById('detailUsaha').classList.add('hidden');
        }
    </script>
</body>
</html> 